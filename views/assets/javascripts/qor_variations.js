"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"===("undefined"==typeof exports?"undefined":_typeof(exports))?require("jquery"):jQuery)}(function(t){function e(n,i){this.$element=t(n),this.options=t.extend({},e.DEFAULTS,t.isPlainObject(i)&&i),this.init()}var n=window._,i="qor.product.variants",o="enable."+i,r="disable."+i,a='.qor-product__property select[data-toggle="qor.chooser"]',s=".qor-product__property-selector",c=".qor-product__table table tbody";return e.prototype={constructor:e,init:function(){this.bind(),this.variants={},this.productMetas=[],this.templateData=[],this.$tbody=this.$element.find(c),this.initMetas()},bind:function(){this.$element.on("select2:select",a,this.selectVariants.bind(this))},unbind:function(){},initMetas:function(){var e=this.$element.find("td.qor-product__meta");n.each(e,function(e){this.productMetas.push(t(e).data("inputName"))}.bind(this)),this.setTemplate()},setTemplate:function(){var t=this.productMetas,e="<tr>";n.each(t,function(t){e=e+"<td>[["+t+"]]</td>"}.bind(this)),this.template=e+"</tr>"},selectVariants:function(e){var n=t(e.target).closest(s).data("variant-type"),i=e.params.data,o=i.text||i.title||i.Name,r=n+"s",a={};a[n]=o,this.variants[r]=this.variants[r]||[],this.variants[r].push(a),this.renderVariants()},renderVariants:function(){var t=this.variants,e=[],i=[],o=void 0,r=this.$tbody,a=void 0,s=this.template;r.html(""),e=n.filter(Object.keys(t),function(e){return t[e].length>0}),o=e.length,0!==o&&(o>1?!function(){var o=t[e[0]],r=t[e[1]];n.each(o,function(t){n.each(r,function(e){a=Object.assign({},e,t),i.push(a)})})}():i.push(t[e[0]]),n.each(i,function(t){r.append(window.Mustache.render(s,t))}))},destroy:function(){this.unbind(),this.$element.removeData(i)}},e.plugin=function(n){return this.each(function(){var o,r=t(this),a=r.data(i);if(!a){if(/destroy/.test(n))return;r.data(i,a=new e(this,n))}"string"==typeof n&&t.isFunction(o=a[n])&&o.apply(a)})},t(function(){var n='[data-toggle="qor.product.variants"]';t(document).on(r,function(i){e.plugin.call(t(n,i.target),"destroy")}).on(o,function(i){e.plugin.call(t(n,i.target))}).triggerHandler(o)}),e});